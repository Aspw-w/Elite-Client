package com.instrumentalist.elite.hacks.features.exploit;

import com.instrumentalist.elite.events.features.*;
import com.instrumentalist.elite.hacks.Module;
import com.instrumentalist.elite.hacks.ModuleCategory;
import com.instrumentalist.elite.hacks.features.exploit.disablermode.DisablerModeManager;
import com.instrumentalist.elite.hacks.features.exploit.disablermode.features.HypixelDisabler;
import com.instrumentalist.elite.utils.IMinecraft;
import com.instrumentalist.elite.utils.move.MovementUtil;
import com.instrumentalist.elite.utils.rotation.RotationUtil;
import com.instrumentalist.elite.utils.value.BooleanValue;
import com.instrumentalist.elite.utils.value.ListValue;
import org.lwjgl.glfw.GLFW;

import java.util.Arrays;

public class Disabler extends Module {

    public Disabler() {
        super("Disabler", ModuleCategory.Exploit, GLFW.GLFW_KEY_UNKNOWN, false, true);
    }

    @Setting
    private static final ListValue disablerMode = new ListValue(
            "Disabler Mode",
            Arrays.asList("Hypixel", "Miniblox Full").toArray(new String[0]),
            "Hypixel"
    );

    private static final DisablerModeManager disablerModeManager = new DisablerModeManager(disablerMode);

    @Setting
    public static final BooleanValue hypixelMotion = new BooleanValue("Hypixel Motion", true, () -> disablerMode.get().equalsIgnoreCase("hypixel"));

    @Setting
    public static final BooleanValue hypixelInventoryMove = new BooleanValue("Hypixel Inventory Move", true, () -> disablerMode.get().equalsIgnoreCase("hypixel"));

    @Setting
    public static final BooleanValue hypixelSprint = new BooleanValue("Hypixel Sprint", true, () -> disablerMode.get().equalsIgnoreCase("hypixel"));

    public static void onEnableFunctions() {
        if (disablerModeManager.currentMode instanceof HypixelDisabler) {
            HypixelDisabler.startDisabler = true;
        }
    }

    public static void onDisableFunctions() {
        if (disablerModeManager.currentMode instanceof HypixelDisabler) {
            HypixelDisabler.startDisabler = false;
            HypixelDisabler.watchDogDisabled = false;
            HypixelDisabler.stuckOnAir = false;
            HypixelDisabler.airStuckTicks = 0;
            HypixelDisabler.airTicks = 0;
            HypixelDisabler.caughtClientStatus = false;
            HypixelDisabler.caughtCloseWindow = false;
            HypixelDisabler.sentFirstOpen = false;
            if (HypixelDisabler.rotated) {
                RotationUtil.INSTANCE.reset();
                HypixelDisabler.rotated = false;
            }
        }
    }

    @Override
    public String tag() {
        return disablerMode.get();
    }

    @Override
    public void onDisable() {
        onDisableFunctions();
    }

    @Override
    public void onEnable() {
        onEnableFunctions();
    }

    @Override
    public void onUpdate(UpdateEvent event) {
        disablerModeManager.onUpdate(event);
    }

    @Override
    public void onMotion(MotionEvent event) {
        disablerModeManager.onMotion(event);
    }

    @Override
    public void onTick(TickEvent event) {
        disablerModeManager.onTick(event);
    }

    @Override
    public void onSendPacket(SendPacketEvent event) {
        disablerModeManager.onSendPacket(event);
    }

    @Override
    public void onReceivedPacket(ReceivedPacketEvent event) {
        disablerModeManager.onReceivedPacket(event);
    }

    @Override
    public void onWorld(WorldEvent event) {
        disablerModeManager.onWorld(event);
    }
}

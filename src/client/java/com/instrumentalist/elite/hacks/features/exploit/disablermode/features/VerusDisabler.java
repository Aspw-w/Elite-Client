package com.instrumentalist.elite.hacks.features.exploit.disablermode.features;

import com.instrumentalist.elite.events.features.*;
import com.instrumentalist.elite.hacks.features.exploit.disablermode.DisablerEvent;
import com.instrumentalist.elite.utils.ChatUtil;
import com.instrumentalist.elite.utils.IMinecraft;
import com.instrumentalist.elite.utils.packet.PacketUtil;
import net.minecraft.entity.Entity;
import net.minecraft.network.packet.Packet;
import net.minecraft.network.packet.c2s.common.CommonPongC2SPacket;

public class VerusDisabler implements DisablerEvent {

    @Override
    public String getName() {
        return "Verus";
    }

    public static int prevTran = 0;
    public static int godTick = 0;

    @Override
    public void onUpdate(UpdateEvent event) {
    }

    @Override
    public void onMotion(MotionEvent event) {
    }

    @Override
    public void onTick(TickEvent event) {
    }

    @Override
    public void onAttack(AttackEvent event) {
    }

    @Override
    public void onSendPacket(SendPacketEvent event) {
        if (IMinecraft.mc.player == null) return;

        Packet<?> packet = event.packet;

        if (packet instanceof CommonPongC2SPacket) {
            int parameter = ((CommonPongC2SPacket) packet).getParameter();
            if (parameter > prevTran) {
                ChatUtil.printChat("saved good " + parameter);
                prevTran = parameter;
            } else if (prevTran != 0) {
                ChatUtil.printChat("removed bad " + parameter);
                event.cancel();
            } else {
                ChatUtil.printChat("can't caught " + parameter);
            }
        }
    }

    @Override
    public void onReceivedPacket(ReceivedPacketEvent event) {
    }

    @Override
    public void onWorld(WorldEvent event) {
        prevTran = 0;
        godTick = 0;
    }
}